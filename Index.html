<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Pruebas</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
        }

        h1, h2 {
            color: #333;
        }

        form {
            margin-bottom: 20px;
        }

        .prueba {
            border: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 10px;
        }

        .imagen-preview img {
            max-width: 100%;
            margin-top: 10px;
        }

        #btn-imprimir {
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #007BFF;
            color: #fff;
            border: none;
            cursor: pointer;
        }

        #btn-imprimir:hover {
            background-color: #0056b3;
        }

        .ocultadas {
            margin-top: 20px;
            padding: 10px;
            border: 1px dashed #999;
        }

        .mostrar-btn {
            margin-top: 10px;
            padding: 5px 10px;
            background-color: #28a745;
            color: #fff;
            border: none;
            cursor: pointer;
        }

        .mostrar-btn:hover {
            background-color: #218838;
        }

        @media print {
            #btn-imprimir, #form-portada, .ocultadas {
                display: none;
            }

            body {
                margin: 0;
                font-size: 12px;
            }

            .prueba {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Gestión de Pruebas de Validación</h1>
    </header>

    <main>
        <section id="portada">
            <h2>Crear Portada</h2>
            <form id="form-portada">
                <label for="titulo">Título:</label>
                <input type="text" id="titulo" name="titulo" required>

                <label for="autor">Autor:</label>
                <input type="text" id="autor" name="autor" required>

                <label for="fecha">Fecha:</label>
                <input type="date" id="fecha" name="fecha" required>
            </form>
        </section>

        <section id="pruebas">
            <h2>Pruebas</h2>
            <div id="lista-pruebas">
                <!-- Las pruebas se generan dinámicamente desde JavaScript -->
            </div>
        </section>

        <section class="ocultadas" id="pruebas-ocultas">
            <h2>Pruebas Ocultas</h2>
            <div id="lista-ocultas">
                <!-- Las pruebas ocultas aparecerán aquí -->
            </div>
        </section>

        <button id="btn-imprimir" onclick="imprimirPagina()">Imprimir Reporte</button>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const pruebas = [
                {
                    id: 1,
                    titulo: "Infraestructura; Hardware",
                    descripcion: "Verificar la existencia de documentación donde se describa la infraestructura del sistema computarizado. (esta información es entregado por el proveedor del sistema computarizado.",
                    evidencia: true
                },
                {
                    id: 2,
                    titulo: "Infraestructura; Hardware",
                    descripcion: "Verificar que el servidor del sistema computarizado está ubicado en un entorno seguro, donde se eviten vulneraciones al sistema. .",
                    evidencia: true
                },
                {
                    id: 3,
                    titulo: "Infraestructura",
                    descripcion: "Verifique la interconexión de todos los dispositivos asociados al sistema computarizado.",
                    evidencia: true
                },
                {
                    id: 4,
                    titulo: "Infraestructura",
                    descripcion: "Verifique la existencia de acuerdos formales por parte del tercero con la compañía para los soportes pos-instalación.",
                    evidencia: true
                },
                {
                    id: 5,
                    titulo: "Infraestructura",
                    descripcion: "Describir las características técnicas de los dispositivos asociados al sistema computarizado",
                    evidencia: true
                },
                {
                    id: 6,
                    titulo: "Infraestructura",
                    descripcion: "El sistema computarizado debe contar con infraestructura necesaria para dar soporte a los requerimientos de integridad de datos.Se debe contar con un cortafuegos adecuado",
                    evidencia: true
                },
                {
                    id: 7,
                    titulo: "Infraestructura",
                    descripcion: "Describir las restricciones de seguridad en el sistema computarizado",
                    evidencia: true
                },
                {
                    id: 8,
                    titulo: "Infraestructura",
                    descripcion: " El sistema computarizado debe estar dotado de un sistema de recuperación de información en caso de desastres.",                  evidencia: true
                },
                {
                    id: 9,
                    titulo: "Infraestructura",
                    descripcion: " El sistema computarizado debe tener la capacidad de recuperar o duplicar archivos en caso de desastre u se cuenta con una tecnología alterna. ",                  evidencia: true
                },
                {
                    id: 10,
                    titulo: "Infraestructura",
                    descripcion: "El software debe tener la capacidad de recuperar los datos de forma precisa durante un tiempo no inferior a _______",                  evidencia: true
                },
                              {
                    id: 11,
                    titulo: "Infraestructura",
                    descripcion: "El sistema computarizado tiene la capacidad de permitir la renovación de contraseñas",                  evidencia: true
                },
                                            {
                    id: 12,
                    titulo: "Infraestructura",
                    descripcion: "El sistema computarizado no debe permitir la generación de contraseñas sencillas",                  evidencia: true
                },
                                                          {
                    id: 13,
                    titulo: "Infraestructura",
                    descripcion: "El sistema computarizado debe permitir la creación de nuevos usuarios",                  evidencia: true
                },
               {
                    id: 14,
                    titulo: "Seguridad del sistema",
                    descripcion: "El sistema computarizado debe permitir el cambio de contraseñas",                  evidencia: true
                },
     {
                    id: 15,
                    titulo: "Seguridad del sistema",
                    descripcion: "El sistema computarizado debe cerrarse despues de un tiempo de inactividad",                  evidencia: true
                },
               {
                    id: 16,
                    titulo: "Jerarquización de usuarios",
                    descripcion: "Verifique en el panel de configuración de usuarios, si el sistema permite la jerarquización de permisos en el sistema ",                  evidencia: true
                },
                             {
                    id: 17,
                    titulo: "Procedimientos",
                    descripcion: "Se debe contar con un procedimiento de uso para el sistema computarizado.  ",                  evidencia: true
                },
                                          {
                    id: 18,
                    titulo: "Backup del sistema",
                    descripcion: "El sistema computarizado debe tener la capacidad de recuperar o duplicar los archivos  en caso de desastre o se cuenta con una tecnología alterna  ",                  evidencia: true
                },
                                                        {
                    id: 19,
                    titulo: "Permisos de usuario",
                    descripcion: "El sistema computarizado debe limitar el acceso al nivel de usuario:____________________ con permisos:________________________________________________________ ",                  evidencia: true
                },
                                                        {
                    id: 20,
                    titulo: "Permisos de usuario",
                    descripcion: "El sistema computarizado debe limitar el acceso al nivel de usuario:____________________ con permisos:________________________________________________________ ",                  evidencia: true
                },
                                                                      {
                    id: 21,
                    titulo: "Permisos de usuario",
                    descripcion: "El sistema computarizado debe limitar el acceso al nivel de usuario:____________________ con permisos:________________________________________________________ ",                  evidencia: true
                },
                                                                      {
                    id: 22,
                    titulo: "Permisos de usuario",
                    descripcion: "El sistema computarizado debe limitar el acceso al nivel de usuario:____________________ con permisos:________________________________________________________ ",                  evidencia: true
                },
                                                                      {
                    id: 23,
                    titulo: "Permisos de usuario",
                    descripcion: "El sistema computarizado debe limitar el acceso al nivel de usuario:____________________ con permisos:________________________________________________________ ",                  evidencia: true
                },
                                                                      {
                    id: 24,
                    titulo: "Contraseñas",
                    descripcion: "El sistema computarizado debe limitar las contraseñas con las siguientes restricciones:____________________________________________________________________________________________________",                  evidencia: true
                },
                                                                                    {
                    id: 25,
                    titulo: "Niveles de acceso",
                    descripcion: "entrar en el aplicativo como usuario administrador o ________________ y verificar cuantos niveles de acceso pueden ser creados en el aplicativo",                  evidencia: true
                },
                                                                                                  {
                    id: 26,
                    titulo: "Creación de usuarios",
                    descripcion: "El sistema computarizado permite la creación de diferentes ID de usuario",                  evidencia: true
                },
                                                                                                                {
                    id: 27,
                    titulo: "Duplicación de usuarios",
                    descripcion: "El sistema computarizado no permite dos ID de usuarios iguales",                  evidencia: true
                },
                                                                                                                              {
                    id: 28,
                    titulo: "Bloqueo de usuarios o eliminación de usuarios",
                    descripcion: "El sistema computarizado permite bloquear o eliminar usuarios",                  evidencia: true
                },
                                                                                                                                           {
                    id: 29,
                    titulo: "Bloqueo de usuarios o eliminación de usuarios",
                    descripcion: "El sistema computarizado permite bloquear o eliminar usuarios",                  evidencia: true
                },
                 {
                    id: 30,
                    titulo: "Bloqueo del sistema",
                    descripcion: ": Ingresar en el aplicativo e ingresar con un usuario invalido y repetir esta acción hasta que el sistema se bloquee",                  evidencia: true
                },
                               {
                    id: 31,
                    titulo: "Intercomunicación entre dispositivos",
                    descripcion: ": verificar la comunicación del sistema computarizado con sus dispositivos asociados",                  evidencia: true
                },
                                             {
                    id: 32,
                    titulo: "Integrabilidad de los datos",
                    descripcion: ": Los registros electronicos no puden ser borrados",                  evidencia: true
                },
                                                           {
                    id: 33,
                    titulo: "Integrabilidad de los datos",
                    descripcion: ": Los registros electronicos no puden ser alterados",                  evidencia: true
                },
                                                                         {
                    id: 34,
                    titulo: "Integrabilidad de los datos",
                    descripcion: ": Los registros electronicos no puden ser copiados",                  evidencia: true
                },
                                                                                       {
                    id: 35,
                    titulo: "Integrabilidad de los datos",
                    descripcion: ": Los registros electronicos cuentan con firma electronica",                  evidencia: true
                },
                                                                                                   {
                    id: 36,
                    titulo: "Integrabilidad de los datos",
                    descripcion: ": Los registros electronicos cuentan se imprimen con hora y fecha",                  evidencia: true
                },
                                                                                                                 {
                    id: 37,
                    titulo: "Integrabilidad de los datos",
                    descripcion: ": Los registros electronicos cuentan con audit trail",                  evidencia: true
                },
                                                                                                                               {
                    id: 38,
                    titulo: "Integrabilidad de los datos",
                    descripcion: ": El audit trail no puede ser borrado o manipulado",                  evidencia: true
                },
                                                                                                                                             {
                    id: 39,
                    titulo: "Integrabilidad de los datos",
                    descripcion: ": la hora y fecha no pueden ser manipuladas",                  evidencia: true
                },
                      {
                    id: 40,
                    titulo: "Funcinalidad del sistema",
                    descripcion: ": El sistema debe:______________________________________________________________________________________________",                  evidencia: true
                },
                                    {
                    id: 41,
                    titulo: "Funcinalidad del sistema",
                    descripcion: ": El sistema debe:______________________________________________________________________________________________",                  evidencia: true
                },
                                    {
                    id: 42,
                    titulo: "Funcinalidad del sistema",
                    descripcion: ": El sistema debe:______________________________________________________________________________________________",                  evidencia: true
                },
            ];

            const listaPruebas = document.getElementById('lista-pruebas');
            const listaOcultas = document.getElementById('lista-ocultas');

            pruebas.forEach(prueba => {
                const pruebaDiv = crearPrueba(prueba);
                listaPruebas.appendChild(pruebaDiv);
            });
        });

        function crearPrueba(prueba) {
            const pruebaDiv = document.createElement('div');
            pruebaDiv.className = 'prueba';
            pruebaDiv.dataset.id = prueba.id;

            pruebaDiv.innerHTML = `
                <h3>${prueba.titulo}</h3>
                <p><strong>Descripción:</strong> ${prueba.descripcion}</p>
                <label>
                    <input type="checkbox" class="ocultar-prueba" onchange="ocultarPrueba(${prueba.id})"> Ocultar esta prueba
                </label>
                ${prueba.evidencia ? `
                <label for="evidencia-${prueba.id}">Evidencia:</label>
                <input type="file" id="evidencia-${prueba.id}" name="evidencia-${prueba.id}" accept="image/*" onchange="mostrarImagen(event, ${prueba.id})">
                <div id="imagen-preview-${prueba.id}" class="imagen-preview"></div>` : ''}
            `;

            return pruebaDiv;
        }

        function mostrarImagen(event, id) {
            const previewDiv = document.getElementById(`imagen-preview-${id}`);
            previewDiv.innerHTML = ''; 

            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.alt = `Evidencia para prueba ${id}`;
                    img.style.maxWidth = '600px';
                    img.style.marginTop = '10px';
                    previewDiv.appendChild(img);
                };
                reader.readAsDataURL(file);
            }
        }

        function ocultarPrueba(id) {
            const pruebaDiv = document.querySelector(`.prueba[data-id="${id}"]`);
            const listaOcultas = document.getElementById('lista-ocultas');

            pruebaDiv.style.display = 'none';

            const pruebaOculta = pruebaDiv.cloneNode(true);
            pruebaOculta.querySelector('.ocultar-prueba').checked = false;
            pruebaOculta.querySelector('.ocultar-prueba').onchange = () => mostrarPrueba(id);

            const mostrarBtn = document.createElement('button');
            mostrarBtn.className = 'mostrar-btn';
            mostrarBtn.textContent = 'Mostrar esta prueba';
            mostrarBtn.onclick = () => mostrarPrueba(id);

            pruebaOculta.appendChild(mostrarBtn);
            listaOcultas.appendChild(pruebaOculta);
        }

        function mostrarPrueba(id) {
            const pruebaDiv = document.querySelector(`.prueba[data-id="${id}"]`);
            pruebaDiv.style.display = 'block';

            const pruebaOculta = document.querySelector(`#lista-ocultas .prueba[data-id="${id}"]`);
            if (pruebaOculta) pruebaOculta.remove();
        }

        function imprimirPagina() {
            window.print();
        }
    </script>
</body>
</html>
